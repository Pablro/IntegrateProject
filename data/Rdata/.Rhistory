######if you parent directory/default directory does not end with ~/Documents#######
getwd()#for checking in your computer
defdir="C:/Users/toros/Desktop/IntegrateProject"
setwd(defdir)
#>>>>>>> main
#Collect the source code from respective directory on your machines.
#Assign sourdir as one child dir, remember to maker sure "IntegrateProject/code/R_code" is right after the path defdir
sourdir=paste(defdir,"IntegrateProject/data/pangenome-data",sep="/")
setwd(sourdir)
defdir="C:/Users/toros/Documents
defdir="C:/Users/toros/Documents"
setwd(defdir)
#>>>>>>> main
#Collect the source code from respective directory on your machines.
#Assign sourdir as one child dir, remember to maker sure "IntegrateProject/code/R_code" is right after the path defdir
sourdir=paste(defdir,"IntegrateProject/data/pangenome-data",sep="/")
setwd(sourdir)
######if you parent directory/default directory does not end with ~/Documents#######
getwd()#for checking in your computer
setwd(defdir)
#>>>>>>> main
#Collect the source code from respective directory on your machines.
#Assign sourdir as one child dir, remember to maker sure "IntegrateProject/code/R_code" is right after the path defdir
sourdir=paste(defdir,"IntegrateProject/data/pangenome-data",sep="/")
setwd(sourdir)
#Loading CDS panmatrix data
#Neisseria sample 1
#sample of 50
load("50Nesse1panmatrixCDS.RData")
setwd(sourdir)
#Loading CDS panmatrix data
#Neisseria sample 1
#sample of 50
load("50Nesse1panmatrixCDS.RData")
getwd()
setwd(defdir)
#>>>>>>> main
#Collect the source code from respective directory on your machines.
#Assign sourdir as one child dir, remember to maker sure "IntegrateProject/code/R_code" is right after the path defdir
sourdir=paste(defdir,"IntegrateProject/data/Rdata",sep="/")
setwd(sourdir)
#Loading CDS panmatrix data
#Neisseria sample 1
#sample of 50
load("50Nesse1panmatrixCDS.RData")
View(smallPanMatNesseOne)
#sample of 400
load("400Nesse1panmatrixCDS.RData")
View(LargePanMatNesseOne)
View(LargePanMatNesseOne)
#sample of 400
load("400Nesse1panmatrixCDS.RData")
load("50Nesse1panmatrixncRNA.RData")
#sample 400
load("400Nesse1panmatrixncRNA.RData")
getwd()
defdir=""C:/Users/toros/Documents"
defdir="C:/Users/toros/Documents"
setwd(defdir)
#>>>>>>> main
#Collect the source code from respective directory on your machines.
#Assign sourdir as one child dir, remember to maker sure "IntegrateProject/code/R_code" is right after the path defdir
sourdir=paste(defdir,"IntegrateProject/data/Rdata",sep="/")
setwd(sourdir)
#Loading CDS panmatrix data
#Neisseria sample 1
#sample of 50
load("50Nesse1panmatrixCDS.RData")
#sample of 400
load("400Nesse1panmatrixCDS.RData")
#Loading ncRNA panmatrix data
#sample 50
load("50Nesse1panmatrixncRNA.RData")
#sample 400
load("400Nesse1panmatrixncRNA.RData")
#Pangenome size analysis
#CDS pangenome
#Convert to matrix
smallPanMatNesseOne<-as.matrix(smallPanMatNesseOne)
LargePanMatNesseOne<-as.matrix(LargePanMatNesseOne)
#Replace NA with zeros
smallPanMatNesseOne<-replace_NA(smallPanMatNesseOne)
library("micropan")
library("collapse")
library("ggplot2")
#Replace NA with zeros
smallPanMatNesseOne<-replace_NA(smallPanMatNesseOne)
LargePanMatNesseOne<-replace_NA(LargePanMatNesseOne)
#Heaps Law:
smallheapsnesse=heaps(smallPanMatNesseOne)
largeheapsnesse=heaps(LargePanMatNesseOne)
smallheapsnesse
largeheapsnesse
# Frequencies estimation by fitting binomial mixture model
fittedsmall <- binomixEstimate(smallPanMatNesseOne, K.range = 3:20)
plot(fittedsmall)
fittedsmall
fittedlarge<- binomixEstimate(LargePanMatNesseOne, K.range = 3:20)
fittedlarge<- binomixEstimate(LargePanMatNesseOne, K.range = 3:20)
print(smallfitted$BIC.tbl)
print(fittedsmall$BIC.tbl)
print(fittedlarge$BIC.tbl)
#Small Dataset
ncomp <- 13
fig4 <- fittedsmall$Mix.tbl %>%
filter(Components == ncomp) %>%
ggplot() +
geom_col(aes(x = "", y = Mixing.proportion, fill = Detection.prob)) +
coord_polar(theta = "y") +
labs(x = "", y = "", title = "Pan-genome gene family distribution",
fill = "Detection\nprobability")
print(fig4)
print(fittedsmall$BIC.tbl)
print(fittedlarge$BIC.tbl)
#Large Dataset
ncomp<-16
fig5<-fittedlarge$Mix.tbl %>%
filter(Components == ncomp) %>%
ggplot() +
geom_col(aes(x = "", y = Mixing.proportion, fill = Detection.prob)) +
coord_polar(theta = "y") +
labs(x = "", y = "", title = "Pan-genome gene family distribution",
fill = "Detection\nprobability")
print(fig5)
#population diversity
fluidity(smallPanMatNesseOne, n.sim = 10)
fluidity(LargePanMatNesseOne,n.sim=10)
unique(as.vector(smallPanMatNesseOne))
# ncRNA pangenome
#Convert to matrix
smallncRNAPanMatNesseOne<-as.matrix(smallncRNAPanMatNesseOne)
LargencRNAPanMatNesseOne<-as.matrix(LargencRNAPanMatNesseOne)
#Replace NA with zeros
smallncRNAPanMatNesseOne<-replace_NA(smallncRNAPanMatNesseOne)
LargencRNAPanMatNesseOne<-replace_NA(LargencRNAPanMatNesseOne)
#Heaps Law:
smallheapsnessencRNA=heaps(smallncRNAPanMatNesseOne)
largeheapsnessencRNA=heaps(LargencRNAPanMatNesseOne)
smallheapsnessencRNA
largeheapsnessencRNA
# Frequencies estimation by fitting binomial mixture model
fittedsmallncRNA <- binomixEstimate(smallncRNAPanMatNesseOne, K.range = 3:20)
fittedlargencRNA<- binomixEstimate(LargencRNAPanMatNesseOne, K.range = 3:20)
print(fittedsmallncRNA$BIC.tbl)
print(fittedlargencRNA$BIC.tbl)
fig6 <- fittedsmallncRNA$Mix.tbl %>%
filter(Components == ncomp) %>%
ggplot() +
geom_col(aes(x = "", y = Mixing.proportion, fill = Detection.prob)) +
coord_polar(theta = "y") +
labs(x = "", y = "", title = "Pan-genome gene family distribution",
fill = "Detection\nprobability")
print(fig6)
#Large Dataset
ncomp<-8
fig7<-fittedlargencRNA$Mix.tbl %>%
filter(Components == ncomp) %>%
ggplot() +
geom_col(aes(x = "", y = Mixing.proportion, fill = Detection.prob)) +
coord_polar(theta = "y") +
labs(x = "", y = "", title = "Pan-genome gene family distribution",
fill = "Detection\nprobability")
print(fig7)
